# 电信CRM客户中心微服务设计

## 📚 项目概述

本项目为电信CRM客户中心微服务系统的完整设计方案，涵盖业务建模、领域模型、业务流程、微服务架构与接口、数据持久化以及高并发场景攻关六大模块。系统采用微服务架构，包含8个核心微服务，支持日处理300万笔业务，峰值QPS 500+。

**项目状态：** 设计阶段  
**最后更新：** 2026-02-21  
**负责团队：** CRM项目组

---

## 📂 项目目录结构

```
PR-CRM/
├── README.md                                        # 本文档（项目索引）
├── 【技术赛道课题】微服务设计挑战 .pdf                # 课题要求说明
├── 01业务建模与限界上下文定义.docx                    # 模块1：限界上下文与业务建模
│
├── 02领域模型设计/                                   # 模块2：领域模型
│   ├── 电信 CRM 客户中心业务规则文档.docx             # 业务规则定义
│   ├── 领域模型图.png                                # 领域模型图
│   └── 状态机图.png                                  # 状态机图
│
├── 03业务流程设计/                                   # 模块3：业务流程
│   ├── 电信CRM客户中心业务流程说明文档（模块3）.docx   # 业务流程说明文档
│   └── 业务泳道图/                                   # 核心业务流程泳道图
│       ├── 客户开户流程.png
│       ├── 客户销户流程.png
│       ├── 用户换卡流程.png
│       └── 用户资料变更流程.png
│
├── 04微服务架构与接口设计/                            # 模块4：架构与接口
│   ├── 接口设计文档.docx                             # API接口定义
│   ├── 跨中心集成方案.docx                           # 跨区域数据同步方案
│   └── 跨服务时序图/                                 # 微服务间调用时序图
│       └── *.jpg                                    # 5张时序图
│
├── 05数据持久画设计/                                  # 模块5：数据持久化
│   ├── 数据一致性方案.docx                           # 分布式数据一致性策略
│   ├── 数据访问策略文档.docx                          # 数据访问模式定义
│   └── 各微服务ER图/                                 # 8个微服务的数据库设计
│       ├── 客户管理微服务数据库ER图.png
│       ├── 用户管理微服务数据库ER图.png
│       ├── 账户管理微服务数据库ER图.png
│       ├── 合约管理数据库ER图.png
│       ├── 权限控制微服务数据库ER图.png
│       ├── 日志监控微服务数据库ER图.png
│       ├── 基础信息微服务数据库ER图.png
│       ├── 跨中心协同微服务数据库ER图.png
│       └── SQL数据库代码.docx                        # 全部建表SQL脚本
│
└── 06高并发与难点攻关/                                # 模块6：高并发与难点
    ├── 高并发场景适配方案.pdf                         # 日300万业务量适配方案
    ├── 分布式事务设计方案.pdf                         # Saga/TCC事务方案
    └── 性能优化策略文档.pdf                           # 全栈性能优化策略
```

---

## 📋 模块说明

### 模块1：业务建模与限界上下文定义

| 文档 | 说明 |
|------|------|
| [01业务建模与限界上下文定义.docx](./01业务建模与限界上下文定义.docx) | 基于DDD方法论，定义电信CRM客户中心的限界上下文与业务建模 |

### 模块2：领域模型设计

| 文档 | 说明 |
|------|------|
| [电信 CRM 客户中心业务规则文档.docx](./02领域模型设计/电信%20CRM%20客户中心业务规则文档.docx) | 核心业务规则定义 |
| [领域模型图.png](./02领域模型设计/领域模型图.png) | 领域模型实体及关系图 |
| [状态机图.png](./02领域模型设计/状态机图.png) | 业务对象状态机流转图 |

### 模块3：业务流程设计

| 文档 | 说明 |
|------|------|
| [业务流程说明文档.docx](./03业务流程设计/电信CRM客户中心业务流程说明文档（模块3）.docx) | 业务流程详细说明 |
| [客户开户流程.png](./03业务流程设计/业务泳道图/客户开户流程.png) | 客户开户泳道图 |
| [客户销户流程.png](./03业务流程设计/业务泳道图/客户销户流程.png) | 客户销户泳道图 |
| [用户换卡流程.png](./03业务流程设计/业务泳道图/用户换卡流程.png) | 用户换卡泳道图 |
| [用户资料变更流程.png](./03业务流程设计/业务泳道图/用户资料变更流程.png) | 用户资料变更泳道图 |

### 模块4：微服务架构与接口设计

| 文档 | 说明 |
|------|------|
| [接口设计文档.docx](./04微服务架构与接口设计/接口设计文档.docx) | 各微服务API接口定义 |
| [跨中心集成方案.docx](./04微服务架构与接口设计/跨中心集成方案.docx) | 跨区域数据同步与集成方案 |
| [跨服务时序图/](./04微服务架构与接口设计/跨服务时序图/) | 微服务间调用时序图（5张） |

### 模块5：数据持久化设计

| 文档 | 说明 |
|------|------|
| [数据一致性方案.docx](./05数据持久画设计/数据一致性方案.docx) | 分布式数据一致性策略 |
| [数据访问策略文档.docx](./05数据持久画设计/数据访问策略文档.docx) | 数据访问模式与策略定义 |
| [各微服务ER图/](./05数据持久画设计/各微服务ER图/) | 8个微服务的数据库ER图 |
| [SQL数据库代码.docx](./05数据持久画设计/各微服务ER图/SQL数据库代码.docx) | 全部微服务建表SQL脚本 |

### 模块6：高并发与难点攻关

| 文档 | 说明 |
|------|------|
| [高并发场景适配方案.pdf](./06高并发与难点攻关/高并发场景适配方案.pdf) | 日300万业务量详细适配方案、早晚高峰策略 |
| [分布式事务设计方案.pdf](./06高并发与难点攻关/分布式事务设计方案.pdf) | Saga/TCC/本地消息表详细实现 |
| [性能优化策略文档.pdf](./06高并发与难点攻关/性能优化策略文档.pdf) | JVM/数据库/缓存/代码全栈性能优化 |

---

## 🏗️ 微服务架构

### 架构总览

```
┌─────────────────────────────────────────────────────┐
│                   API 网关 (Gateway)                 │
└─────────────────────────────────────────────────────┘
                          │
        ┌─────────────────┼─────────────────┐
        │                 │                 │
   ┌────▼─────┐     ┌────▼─────┐     ┌────▼─────┐
   │ 客户管理  │     │ 用户管理  │     │ 账户管理  │
   │ 微服务   │     │ 微服务   │     │ 微服务   │
   └──────────┘     └──────────┘     └──────────┘
        │                 │                 │
        └─────────────────┼─────────────────┘
                          │
        ┌─────────────────┼─────────────────┐
        │                 │                 │
   ┌────▼─────┐     ┌────▼─────┐     ┌────▼─────┐
   │ 合约管理  │     │ 权限控制  │     │ 日志监控  │
   │ 微服务   │     │ 微服务   │     │ 微服务   │
   └──────────┘     └──────────┘     └──────────┘
        │                 │                 │
        └─────────────────┼─────────────────┘
                          │
        ┌─────────────────┼─────────────────┐
        │                                   │
   ┌────▼─────┐     ┌──────────────────────▼──┐
   │ 基础信息  │     │   跨中心协同微服务        │
   │ 微服务   │     │   (Cross-Center Sync)   │
   └──────────┘     └─────────────────────────┘
```

### 服务职责

| 微服务 | 核心职责 | 主要实体 |
|-------|---------|---------|
| **客户管理** | 客户信息管理、分类、关系维护 | Customer, CustomerType, CustomerRelation |
| **用户管理** | 用户账号、认证、登录管理 | User, UserProfile, LoginRecord |
| **账户管理** | 账户余额、交易、账单管理 | Account, Transaction, Bill |
| **合约管理** | 合约签订、变更、生命周期 | Contract, ContractChange, ContractTemplate |
| **权限控制** | RBAC权限管理 | Role, Permission, UserRole |
| **日志监控** | 操作日志、审计、监控 | OperationLog, AuditLog, MonitorData |
| **基础信息** | 字典、配置、参数管理 | Dictionary, Config, Parameter |
| **跨中心协同** | 跨区域数据同步、对账 | SyncTask, ConflictRecord |

---

## 🗄️ 数据库设计

8个微服务均有独立的数据库ER图设计，位于 [`05数据持久画设计/各微服务ER图/`](./05数据持久画设计/各微服务ER图/)：

| 微服务 | ER图 | 说明 |
|-------|------|------|
| 客户管理微服务 | ✅ | 客户信息、分类、关系管理 |
| 用户管理微服务 | ✅ | 用户账号、认证、资料管理 |
| 账户管理微服务 | ✅ | 账户余额、交易、账单管理 |
| 合约管理微服务 | ✅ | 合约签订、变更、生命周期管理 |
| 权限控制微服务 | ✅ | 角色、权限、访问控制（RBAC） |
| 日志监控微服务 | ✅ | 操作日志、监控、审计追踪 |
| 基础信息微服务 | ✅ | 字典、配置、参数管理 |
| 跨中心协同微服务 | ✅ | 跨区域数据同步、对账、冲突解决 |

**SQL脚本：** [`SQL数据库代码.docx`](./05数据持久画设计/各微服务ER图/SQL数据库代码.docx)

---

## 🚀 高并发设计方案

模块6提供了三份核心技术方案文档，全面覆盖高并发场景下的系统设计：

### 核心方案

1. **[高并发场景适配方案](./06高并发与难点攻关/高并发场景适配方案.pdf)** — 日300万业务量详细设计
   - 业务量拆分与峰值计算
   - 早高峰（8:00-10:00）/ 晚高峰（18:00-21:00）应对策略
   - 分层流量控制（Nginx → Gateway → Service → Database）
   - 三级缓存架构优化
   - 资源容量规划

2. **[分布式事务设计方案](./06高并发与难点攻关/分布式事务设计方案.pdf)** — Saga/TCC详细实现
   - Saga模式（长事务、最终一致性）
   - TCC模式（短事务、强一致性）
   - 本地消息表模式
   - 事务监控和恢复机制

3. **[性能优化策略文档](./06高并发与难点攻关/性能优化策略文档.pdf)** — 全栈性能优化
   - JVM调优（G1 GC配置）
   - 数据库优化（索引、SQL、连接池）
   - 缓存优化（Redis、Caffeine本地缓存）
   - 代码级优化（避免N+1、批量操作、异步化）

### 性能目标

| 指标 | 目标值 | 说明 |
|-----|-------|------|
| 日处理量 | ≥ 3,000,000 笔 | 支持业务增长 |
| 峰值QPS | ≥ 500 | 晚高峰场景 |
| 平均响应时间 | < 200ms | 接口平均响应时间 |
| P99响应时间 | < 1000ms | 99%请求响应时间 |
| 系统可用性 | ≥ 99.9% | 年度可用性 |

---

## 📝 建议技术栈

```yaml
框架: Spring Boot 2.7+ / Spring Cloud Alibaba
注册与配置中心: Nacos
服务网关: Spring Cloud Gateway
服务调用: OpenFeign / Dubbo
熔断限流: Sentinel
数据库: MySQL 8.0（主从） / ShardingSphere（分库分表）
缓存: Redis Cluster + Caffeine
消息队列: RabbitMQ / Kafka
搜索引擎: Elasticsearch
分布式事务: Seata
监控: SkyWalking / Prometheus + Grafana / ELK
```